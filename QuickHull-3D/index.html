<!DOCTYPE html>

<html>
    <head>
        <meta charset="utf-8"/>
        <title> QuickHull 3D |  Alex Catal치n</title>
        <link rel="stylesheet" href="/css/style.css" />
        <link rel="stylesheet" href="/css/syntax.css" />
        <link rel="stylesheet" href="/css/menu.css" />
        <link rel="stylesheet" href="/css/sidebar.css" />
        <meta name="description" content="Game Engineer"/>
        <meta name="author" content="Alex Catal치n"/>
        <link rel="icon" href="/favicon.ico" type="image/x-icon">
        <link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/feed.xml" />

        <link rel="stylesheet" href="/resources/fontello/css/fontello.css">
        <link rel="stylesheet" href="/resources/fontello/css/animation.css">

        <script type="text/javascript"
            src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
        </script>

        <!--[if IE 7]><link rel="stylesheet" href="/resources/fontello/css/fontello-ie7.css"><![endif]-->
    </head>

    <body>
        
        <header>
            <h1><a href="/">Alex Catal치n</a></h1>
                <h4>Game Engineer</h4>
            <hr />
        </header>

        <main>

            <div id="menu">
                <ul>
                    <a href="/"><li><i class="icon-home"></i>Home</li></a>
                    <li><i class="icon-tag"></i>Categories 
                        <ul>
                            
                            <a href="/computational geometry"><li>computational geometry</li></a>
                            
                            <a href="/graphics"><li>graphics</li></a>
                            
                            <a href="/interactive systems"><li>interactive systems</li></a>
                            
                            <a href="/unity3d"><li>unity3d</li></a>
                            
                            <a href="/games"><li>games</li></a>
                            
                        </ul>
                    </li>

                    <a href="/archive"><li><i class="icon-th"></i>Archive</li></a>
                    <li><i class="icon-user"></i>Personal
                        <ul>
                            <a href="/curriculum"><li>Curriculum</li></a>
                            <a href="/cover-letter"><li>Cover Letter</li></a>
                        </ul>
                    </li>
                </ul>
            </div>
            <article>
        <header>
            <h2>QuickHull 3D</h2>
            <metadata>
                <span class="date"><i class="icon-clock"></i><time datetime="2013-04-13">Apr 13, 2013</time></span> | <span class="category"><i class="icon-tag"></i> 
                
                <a href="/computational geometry" >computational geometry</a>
                 
                </span> | <span class="author"><i class="icon-user"></i> Alex Catal치n</span>
            </metadata>
            <img src="/assets//2013-04-13-QuickHull-3D/header.jpg" >
        </header>

        <div class="entry"><p style="text-align:justify;">
    At the Computational Geometry course I have implemented the Quickhull algorithm for its application in 3D, following the paper <em>&quot;Barber, C. B., Dobkin, D. P., &amp; Huhdanpaa, H. T. (1996). The Quickhull algorithm for convex hulls. ACM Trans. on Mathematical Software, 22(4), 469&mdash;483&quot;.</em> And following the example of <a href="http://www.cse.unsw.edu.au/~lambert/java/3d/hull.html?dimension=3D&amp;model=QuickHull&amp;seed=45123&amp;npoints=20&amp;frame=11&amp;view=v[0.55695075,-0.051542707,-0.8289446]" target="_blank" title="QuickHull">this java applet</a> developed by UNSW School of Computer Science and Engineering.
</p>


<p id="more">
    <!--more--> 
</p>


<div>
    <h2>
        <strong>Algorithm</strong>
    </h2>
    <p style="text-align:justify;">
        The algorithm proposed by the paper says:
    </p>
    <blockquote>
        <p style="text-align:justify;">
            <span style="font-family: georgia, serif; font-style: italic;">create a simplex of </span><em style="font-family: georgia, serif;">d</em><span style="font-family: georgia, serif; font-style: italic;">+1 points</span>
        </p>
        <p style="text-align:justify;">
            <span style="font-family: georgia, serif; font-style: italic;">for each facet </span><em style="font-family: georgia, serif;">F</em>
        </p>
        <p style="margin-left: 40px;">
            <span style="font-family: georgia, serif; font-style: italic;">for each unassigned point </span><em style="font-family: georgia, serif;">p</em>
        </p>
        <p style="margin-left: 80px;">
            <span style="font-family: georgia, serif; font-style: italic;">if </span><i style="font-family: georgia, serif;">p</i><span style="font-family: georgia, serif; font-style: italic;"> is above </span><em style="font-family: georgia, serif;">F</em>
        </p>
        <p style="margin-left: 120px;">
            <span style="font-family: georgia, serif; font-style: italic;">assign </span><em style="font-family: georgia, serif;">p</em><span style="font-family: georgia, serif; font-style: italic;"> to </span><em style="font-family: georgia, serif;">F</em><span style="font-family: georgia, serif; font-style: italic;">&#39;s outside set</span>
        </p>
        <p style="text-align:justify;">
            <span style="font-family: georgia, serif; font-style: italic;">for each facet </span><em style="font-family: georgia, serif;">F</em><span style="font-family: georgia, serif; font-style: italic;"> with a non-empty outside set</span>
        </p>
        <p style="margin-left: 40px;">
            <span style="font-family: georgia, serif; font-style: italic;">select the furthest point </span><em style="font-family: georgia, serif;">p</em><span style="font-family: georgia, serif; font-style: italic;"> of </span><em style="font-family: georgia, serif;">F</em><span style="font-family: georgia, serif; font-style: italic;">&#39;s outside set</span>
        </p>
        <p style="margin-left: 40px;">
            <span style="font-family: georgia, serif; font-style: italic;">initialize the visible set </span><em style="font-family: georgia, serif;">V </em><span style="font-family: georgia, serif; font-style: italic;">to </span><em style="font-family: georgia, serif;">F</em>
        </p>
        <p style="margin-left: 40px;">
            <span style="font-family: georgia, serif; font-style: italic;">for all unvisited neighbors </span><em style="font-family: georgia, serif;">N</em><span style="font-family: georgia, serif; font-style: italic;"> of facets in </span><em style="font-family: georgia, serif;">V</em>
        </p>
        <p style="margin-left: 80px;">
            <span style="font-family: georgia, serif; font-style: italic;">if </span><em style="font-family: georgia, serif;">p</em><span style="font-family: georgia, serif; font-style: italic;"> is above </span><em style="font-family: georgia, serif;">N</em>
        </p>
        <p style="margin-left: 120px;">
            <span style="font-family: georgia, serif; font-style: italic;">add </span><em style="font-family: georgia, serif;">N</em><em style="font-family: georgia, serif;"> </em><span style="font-family: georgia, serif; font-style: italic;">to </span><em style="font-family: georgia, serif;">V</em>
        </p>
        <p style="margin-left: 40px;">
            <span style="font-family: georgia, serif; font-style: italic;">the boundary of </span><em style="font-family: georgia, serif;">V</em><span style="font-family: georgia, serif; font-style: italic;"> is the set of horizon ridges </span><em style="font-family: georgia, serif;">H</em>
        </p>
        <p style="margin-left: 40px;">
            <span style="font-family: georgia, serif; font-style: italic;">for each ridge </span><em style="font-family: georgia, serif;">R</em><span style="font-family: georgia, serif; font-style: italic;"> in </span><em style="font-family: georgia, serif;">H</em>
        </p>
        <p style="margin-left: 80px;">
            <span style="font-family: georgia, serif; font-style: italic;">create a new facet from </span><em style="font-family: georgia, serif;">R</em><span style="font-family: georgia, serif; font-style: italic;"> and </span><em style="font-family: georgia, serif;">p</em>
        </p>
        <p style="margin-left: 80px;">
            <span style="font-family: georgia, serif; font-style: italic;">link the new facet to its neighbors</span>
        </p>
        <p style="margin-left: 40px;">
            <span style="font-family: georgia, serif; font-style: italic;">for each new facet </span><em style="font-family: georgia, serif;">F&#39;</em>
        </p>
        <p style="margin-left: 80px;">
            <span style="font-family: georgia, serif; font-style: italic;">for each unassigned point </span><em style="font-family: georgia, serif;">q</em><span style="font-family: georgia, serif; font-style: italic;"> in an outside set of a facet in </span><em style="font-family: georgia, serif;">V</em>
        </p>
        <p style="margin-left: 120px;">
            <span style="font-family: georgia, serif; font-style: italic;">if </span><em style="font-family: georgia, serif;">q</em><span style="font-family: georgia, serif; font-style: italic;"> is above </span><em style="font-family: georgia, serif;">F&#39;</em>
        </p>
        <p style="margin-left: 160px;">
            <span style="font-family: georgia, serif; font-style: italic;">assign </span><em style="font-family: georgia, serif;">q </em><span style="font-family: georgia, serif; font-style: italic;">to </span><em style="font-family: georgia, serif;">F&#39;</em><span style="font-family: georgia, serif; font-style: italic;">&#39;s outside set</span>
        </p>
        <p style="margin-left: 40px;">
            <span style="font-family: georgia, serif; font-style: italic;">delete the facets in </span><em style="font-family: georgia, serif;">V</em>
        </p>
    </blockquote>
    <p style="text-align:justify;">
        I made some changes on my implementation but the essence is the same.
    </p>
    <p style="text-align:justify;">
        <img src="/assets/2013-04-13-QuickHull-3D/quickhull-initial.jpg">
    </p>
</div>


<div>
    <h2>
        <strong>Data Structures</strong>
    </h2>
    <p style="text-align:justify;">
        Before explaining the implementation, it should explain how are the data structures.
    </p>
    <ul>
        <li style="text-align: justify;">
            <code>vector3f </code>is a 3 <code>float </code>vector with some geometrical functions (dotProduct, crossProduct, etc...)
        </li>
        <li style="text-align: justify;">
            <code>facet </code>is a 3 <code>int </code>vector and a <code>std::Vector&lt;int&gt;</code>, to store the indices of the 3 points of the triangle and the indices of the outside points.
        </li>
        <li style="text-align: justify;">
            All the collection used are class <code>std::Vector</code>
        </li>
        <li style="text-align: justify;">
            The QuickHull class has:
            <ul>
                <li>
                    A points collection is a <code style="line-height: 1.6em;">std::Vector &lt;vector3f&gt;</code>, where there are stored all the points. This should not be changed any time.
                </li>
                <li>
                    A facets collection is a <code style="line-height: 1.6em;">std::Vector &lt;facet&gt;</code>, where there are stored all the facets.
                </li>
            </ul>
        </li>
    </ul>
    <h2>
        <strong>Implementation</strong>
    </h2>
    <p style="text-align:justify;">
        The first thing to do is calculate the simplex. The simplex is a triangle that separates points in two areas. This will take 3 points, two with maximum X and Y coordinate, and another with the minimum Z coordinate of the whole set of points.
    </p>
    <p style="text-align:justify;">
        <img src="/assets/2013-04-13-QuickHull-3D/quickhull-simplex.jpg">
    </p>
    <p style="text-align:justify;">
        After the simplex is created, split the remaining points that are visible for the two facets from the simplex (a triangle in 3D has 2 faces). To know if a point is visible for a facet, we have to calculate if this point is above the facet. And to know if a point is above a plane, we evaluate the point on the plane normal.
    </p>
    <p style="text-align:justify;">
        Now the main loop begins. In each iteration and for each facet, the facet&#39;s furthest point is calculated. This point <em style="font-size: 13px;">p</em> is checked whether is visible from the facets neighbourhood, the neighbourhood facets are the ones that have at least one vertex in common, then all ridges and outside points from the neighbourhood facets are saved in different collections.
    </p>
    <p style="text-align:justify;">
        The ridge collection determine the boundary from the hole that is created when the neighbourhood facets are deleted. Using this boundary and the furthest point <em style="font-size: 13px;">p</em> will create new triangles using the Delaunay algorithm. 
    </p>
    <p style="text-align:justify;">
        Finally once created the new triangles will split the points of collection points on the new triangles created. This loop is executed while there are facets with outside points.
    </p>
    <p style="text-align:justify;">
        <img src="/assets/2013-04-13-QuickHull-3D/quickhull-final.jpg">
    </p>
</div>


<div>
    <h2>
        <strong>Solved Facts</strong>
    </h2>
    <h3>
        <strong>Triangle orientation</strong>
    </h3>
    <p style="text-align:justify;">
        One of the problems that can happen when you are adding new triangles on a closed polygon, is that according to the order of the vertices of the triangles, the normal of the triangle is pointing inside the polygon. This is a problem because to perform calculations to find the location of the points on the triangle requires that the normal is facing outside the polygon.
    </p>
    <p style="text-align:justify;">
        The solution implemented, was using a reference point. This point must always remain within the polygon, even in the first iteration. Therefore, is calculated the baricenter of the initial simplex.
    </p>
    <p style="text-align:justify;">
    <iframe width="560" height="420" src="http://www.youtube.com/embed/9Nx3GaHteCc?color=white&theme=light"></iframe>
    </p>
    <p style="text-align:justify;">
        Here is the source code: <a href="http://www.madowen.es/wp-content/uploads/2014/01/QuickHull-src.zip"><i class="icon-download"></i>SRC</a>
    </p>
</div>

</div>

        <footer><!-- additional info --></footer>

</article>

        </main>
        <aside id="sidebar">
            <img src="/perfil.jpg">
            <p>My name is Alex Catal치n (<a href="https://github.com/madowen">MaDowen</a>) born in 1988 at Barcelona, Spain.</p>
            <p>Computer Engineer since 2015, I have proffesional experience on web and mobile development. Right now I'm working hard to get into the Game Industry in the future.</p>
            <p>I've been coding for over 7 years with multiple languajes. I have knowledge of 3D Programming. Now I'm learning WebGL and developing an Engine with it for my Degree Final Project.</p>
        </aside>

        <footer>
            <hr />
            <p>
                &copy; <time>2014</time> Alex Catal치n
                <a href="mailto:mad.alexcc@gmail.com"><i class="icon-mail"></i></a>
                <a href="/feed.xml"><i class="icon-rss"></i>
            </p>
        </footer>

    </body>

</html>